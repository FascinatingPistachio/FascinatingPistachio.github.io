<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>…</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    font-family: 'Roboto Mono', monospace;
    background: #000;
    color: #fff;
}

#container {
    position: relative;
    width: 100%;
    height: 100%;
}

iframe#mainframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
    z-index: 1;
    opacity: 0;
    transition: opacity 1s ease;
}

.overlay {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: 2;
    pointer-events: none;
    overflow: visible;
}

.page {
    position: absolute;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 2em;
    transition: opacity 1s ease;
    z-index: 3;
}

.active { opacity: 1; }
.hidden { opacity: 0; pointer-events: none; }

h1 { font-size: 4em; color: #ff4444; text-shadow: 0 0 10px #ff0000; }
p { max-width: 600px; font-size: 1.2em; color: #ccc; }
a { color: #ff6666; text-decoration: none; margin-top: 1em; cursor: pointer; }
a:hover { color: #ff0000; text-shadow: 0 0 10px #ff0000; }

.rift {
    position: absolute;
    width: 150px;
    height: 150px;
    border: 2px dashed #ff4444;
    box-shadow: 0 0 20px #ff0000;
    border-radius: 50%;
    opacity: 0.3;
    pointer-events: none;
    z-index: 4;
    transition: transform 0.2s ease, opacity 0.2s ease;
}

.overlay-text {
    position: absolute;
    font-size: 2em;
    color: #ff4444;
    text-shadow: 0 0 10px #ff0000;
    pointer-events: none;
    z-index: 5;
    transition: transform 0.1s linear; /* smooth movement */
}
</style>
</head>
<body>
<div id="container">
    <iframe id="mainframe" src="/" scrolling="yes"></iframe>
    <div class="overlay" id="overlay"></div>

    <div id="page1" class="page active">
        <h1>…</h1>
        <p>The shadows watch you.<br>Do you really want to leave?</p>
        <a onclick="triggerLeave()">Leave</a>
        <a onclick="alert('Step deeper into the unknown...')">Step Deeper</a>
    </div>
</div>

<script>
const overlay = document.getElementById('overlay');
const rifts = [];
const overlayTexts = [];

// Create rifts
for (let i = 0; i < 8; i++) {
    const rift = document.createElement('div');
    rift.className = 'rift';
    rift.style.top = Math.random() * window.innerHeight + 'px';
    rift.style.left = Math.random() * window.innerWidth + 'px';
    overlay.appendChild(rift);
    rifts.push(rift);
}

// Create overlay text
const messages = ["If you leave…","You will not return","The shadows follow you"];
messages.forEach((msg, i) => {
    const text = document.createElement('div');
    text.className = 'overlay-text';
    text.innerText = msg;
    text.style.top = (100 + i*200) + 'px';
    text.style.left = (50 + i*200) + 'px';
    overlay.appendChild(text);
    overlayTexts.push(text);
});

// Trigger leave sequence
function triggerLeave() {
    document.getElementById('page1').classList.add('hidden');
    const iframe = document.getElementById('mainframe');
    iframe.style.opacity = 1;
    history.pushState({}, '', '/');
}

// Smooth overlay scroll sync using requestAnimationFrame
const iframe = document.getElementById('mainframe');
iframe.addEventListener('load', () => {
    const iframeWindow = iframe.contentWindow;

    function updateOverlay() {
        const scrollTop = iframeWindow.scrollY || iframeWindow.pageYOffset || 0;
        const scrollLeft = iframeWindow.scrollX || iframeWindow.pageXOffset || 0;

        // Rifts move slightly dynamically
        rifts.forEach((rift, i) => {
            const offsetX = Math.sin(scrollTop*0.01 + i) * 30;
            const offsetY = Math.cos(scrollLeft*0.01 + i) * 30;
            rift.style.transform = `translate(${offsetX}px, ${offsetY}px) rotate(${scrollTop*0.05}deg)`;
        });

        // Overlay text moves in opposite direction to appear pinned
        overlayTexts.forEach(text => {
            text.style.transform = `translate(${-scrollLeft}px, ${-scrollTop}px)`;
        });

        requestAnimationFrame(updateOverlay);
    }

    updateOverlay();
});
</script>
</body>
</html>
