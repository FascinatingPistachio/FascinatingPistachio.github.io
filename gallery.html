<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train Gallery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    

<style>
        body {
            background-color: #e8e6e3;
            /* Switched to Georgia for a retro feel */
            font-family: Georgia, 'Times New Roman', Times, serif;
        }

        /* TRAIN GALLERY STYLES */
        .gallery-room {
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            width: max-content;
            gap: 2.5rem;
            padding: 2rem 4rem 8rem; 
        }

        .art-piece {
            text-align: center;
            transition: transform 0.3s ease;
            flex-shrink: 0;
            display: flex; /* Use flexbox for layout */
            flex-direction: column; /* Stack vertically */
            align-items: center; /* Center horizontally */
        }


        .gallery-room .art-piece:hover {
            transform: translateY(-5px);
        }
        
        .art-piece a {
            display: block;
            text-decoration: none;
            color: inherit;
        }
        
        .art-piece a .frame:hover {
            transform: translateY(-5px);
        }

        /* --- Frame Base Style --- */
        .frame {
            position: relative;
            border: 1px solid #4a2a0a;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3), inset 0 0 10px rgba(0,0,0,0.4);
            padding: 12px;
            /* border-radius: 6px; */ /* Removed for square corners */
            width: 280px; /* Fixed width */
            overflow: hidden;
            margin: 0 auto;
            transition: transform 0.3s ease;
        }
        
        /* --- Frame Variations --- */
        /* 1. Standard Wood (default) */
        .frame-wood {
            background: #6a4a2a;
            background-image: linear-gradient(0deg, rgba(0,0,0,0.2) 0%, rgba(255,255,255,0.05) 50%, rgba(0,0,0,0.2) 100%), 
                              linear-gradient(90deg, #6a4a2a 0%, #8b5a2b 30%, #6a4a2a 60%, #8b5a2b 100%);
            border: 1px solid #4a2a0a;
        }
        
        /* 2. Dark Wood */
        .frame-dark-wood {
            background: #4a2a0a;
            background-image: linear-gradient(0deg, rgba(0,0,0,0.3) 0%, rgba(255,255,255,0.05) 50%, rgba(0,0,0,0.3) 100%), 
                              linear-gradient(90deg, #4a2a0a 0%, #5a3a1b 30%, #4a2a0a 60%, #5a3a1b 100%);
            border: 1px solid #2a1a00;
        }
        
        /* 3. Modern Black */
        .frame-black {
            background: #1a1a1a;
            background-image: linear-gradient(0deg, rgba(0,0,0,0.2) 0%, rgba(255,255,255,0.05) 50%, rgba(0,0,0,0.2) 100%);
            border: 1px solid #000;
        }


        .frame::after {
            content: "";
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            background: linear-gradient(135deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.0) 100%);
            mix-blend-mode: screen;
            /* border-radius: 6px; */ /* Removed for square corners */
        }

        .frame img {
            width: 100%;
            height: auto;
            display: block;
            /* border-radius: 2px; */ /* Removed for square corners */
        }

        .plaque {
            text-align: center;
            margin-top: 1rem;
            background: linear-gradient(to bottom, #f0e68c 0%, #d4af37 50%, #b98b1d 100%);
            padding: 0.75rem 0.75rem;
            min-height: 4.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px; /* Plaques can stay rounded */
            border: 1px solid #b98b1d;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            width: 85%;
            margin-left: auto;
            margin-right: auto;
        }

        .plaque p {
            font-size: 0.9rem;
            color: #111;
            line-height: 1.4;
            margin: 0;
        }
        
        /* Audio Button Style */
        .play-audio-btn {
            background-color: #f7f7f2; /* Match nav background */
            border: 1px solid #aaa;
            color: #333;
            padding: 0.3rem 0.6rem;
            font-size: 1.2rem; /* Make icon slightly larger */
            line-height: 1;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
            margin-top: 0.75rem; /* Space below plaque */
            border-radius: 0; /* Square corners */
        }
        .play-audio-btn:hover {
            background-color: #e0e0d8;
            color: #000;
        }


        .art-piece.featured .frame {
            background: #5a2a0a;
            background-image: linear-gradient(0deg, rgba(0,0,0,0.3) 0%, rgba(255,255,255,0.05) 50%, rgba(0,0,0,0.3) 100%), 
                              linear-gradient(90deg, #7a3f18 0%, #a05a2c 30%, #7a3f18 60%, #a05a2c 100%);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 15px rgba(0,0,0,0.5);
            padding: 15px;
            width: 460px; /* Fixed width */
        }

        .art-piece.featured .plaque {
            background: linear-gradient(to bottom, #fffacd 0%, #ffd700 50%, #cfa500 100%);
            border-color: #cfa500;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            width: 85%;
            max-width: 420px;
        }
        
        /* Updated Nav Link Style for uniformity */
        .nav-link {
            display: inline-block; /* Match button */
            background-color: #e2e8f0; /* gray-200 */
            color: #2d3748; /* gray-800 */
            font-weight: 600; /* font-semibold */
            padding-top: 0.5rem; /* py-2 */
            padding-bottom: 0.5rem;
            padding-left: 1rem; /* px-4 */
            padding-right: 1rem;
            border: 2px solid #a0aec0; /* border-gray-500 */
            text-decoration: none; /* no-underline */
            border-radius: 0; /* Ensure square corners */
            margin: 0.5rem 1rem; /* Spacing */
            transition: background-color 0.2s ease;
        }
        
        .nav-link:hover {
             background-color: #cbd5e0; /* gray-300 */
             color: #2d3748; /* Keep text color same on hover */
             border-color: #a0aec0; /* Keep border color same */
        }
                
        .horizontal-scroll-wrapper {
            position: relative;
        }
        .sticky-container {
            position: sticky;
            width: 100%;
        }

        /* Retro Info Box Style */
        .info-box {
            background-color: white;
            border: 2px solid #a0aec0; /* gray-500 */
            padding: 1.5rem; /* p-6 */
            border-radius: 0; /* No rounded corners */
            margin-bottom: 3rem; /* mb-12 */
            max-width: 48rem; /* max-w-5xl */
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Duck Encore Sections */
        .duck-text-room {
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            width: max-content;
            gap: 5rem;
            padding: 10rem 4rem;
            align-items: center;
        }
        .duck-text {
            font-size: 1.5rem;
            color: #555;
            flex-shrink: 0;
            width: 100vw;
            text-align: center;
            padding: 0 2rem;
        }
        
        .scroll-up-wrapper {
            position: relative;
        }
        
        .scroll-up-content {
            position: sticky;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
            padding: 2rem;
        }

        /* --- MOBILE STYLES --- */
        @media (max-width: 767px) {
            /* Disable sticky/scroll functionality */
            .horizontal-scroll-wrapper,
            .scroll-up-wrapper {
                height: auto !important; /* Override JS height calculation */
            }

            .sticky-container,
            .scroll-up-content {
                position: relative; /* Disable sticky */
                top: auto !important;
                transform: none !important; /* Reset transforms */
            }

            /* Change gallery to vertical layout */
            .gallery-room {
                display: flex;
                flex-direction: column; /* Stack images vertically */
                width: 100%;
                padding: 2rem 1rem; /* Adjust padding for mobile */
                gap: 2.5rem;
            }

            /* Center the art pieces */
            .art-piece {
                width: 100%;
            }
            
            .frame {
                 margin: 0 auto;
                 width: 280px; 
                 max-width: 90%; /* For very small screens */
            }

            .art-piece.featured .frame {
                width: 460px;
                max-width: 90%; /* For very small screens */
            }
            
            /* Hide all the duck stuff on mobile */
            .text-center.mt-12.mb-8, /* First duck */
            [data-scroll-id="duck1"],  /* Second duck text */
            [data-scroll-id="duck2"] { /* Third duck image */
                display: none;
            }
        }
    </style>
</head>
<body class="text-[#222] min-h-screen flex flex-col">

    <!-- Background Music Player -->
    <audio id="background-music-player" autoplay loop>
        <source src="https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/Velvet%20Rails.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Voice Note Player (hidden) -->
    <audio id="voice-note-player"></audio>


    <header class="bg-[#f5f5f0] text-center p-6 md:p-8 border-b border-[#ccc] z-20 relative">
        <h1 class="text-3xl md:text-4xl font-bold text-[#222] mb-2">Train Gallery</h1>
        <p class="text-[#555] text-base md:text-lg">An interactive collection of my favorite trains.</p> 
    </header>

    <!-- Restored Navigation with Home Link -->
    <nav id="main-nav" class="flex justify-center bg-[#f7f7f2] border-b border-[#ccc] p-2 flex-wrap sticky top-0 z-10">
        <!-- Removed Emoji -->
        <a href="index.html" class="nav-link">Home</a> 
    </nav>

    <main class="flex-grow p-4 md:p-8 w-full max-w-full mx-auto">
        
        <!-- Train Gallery Section -->
        <section id="trains" class="section-content">
            <div id="train-info-block" class="info-box">
                <h2 id="train-title" class="text-3xl font-bold text-center mb-4"></h2>
                <p id="train-desc" class="text-lg text-center text-[#333] mb-6"></p>
                <div class="border-t border-[#ccc] pt-6">
                    <h3 id="train-about-title" class="text-2xl font-semibold text-center mb-3"></h3>
                    <p id="train-about-text" class="text-base text-[#444] text-center max-w-3xl mx-auto leading-relaxed"></p>
                </div>
            </div>
            
            <!-- Main Gallery -->
            <div class="horizontal-scroll-wrapper" data-scroll-id="gallery">
                <div class="sticky-container">
                    <div id="train-gallery-grid" class="gallery-room">
                        <!-- Art pieces are injected here -->
                    </div>
                </div>
            </div>
            
            <!-- First Duck Message -->
            <div class="text-center mt-12 mb-8">
                <p class="text-lg text-[#555] mb-4">
                    ...you reached the end. Here's a duck.
                </p>
                <img src="https://random-d.uk/api/v2/randomimg?t=1" alt="A random duck" class="mx-auto border-2 border-gray-500 w-64 h-64 object-cover" onerror="this.src='https://placehold.co/256x256/ffffff/777777?text=Duck+Error'; this.onerror=null;">
            </div>
            
            <!-- Duck Encore 1: Scroll Left -->
            <div class="horizontal-scroll-wrapper" data-scroll-id="duck1">
                <div class="sticky-container">
                    <div class="duck-text-room">
                        <div class="duck-text">...if you want another picture of a duck...</div>
                        <div class="duck-text">yes?</div>
                    </div>
                </div>
            </div>
            
            <!-- Duck Encore 2: Scroll Up -->
            <div class="scroll-up-wrapper" data-scroll-id="duck2">
                 <div class="scroll-up-content">
                    <p class="text-lg text-[#555] mb-4">...here is another duck.</p>
                    <img src="https://random-d.uk/api/v2/randomimg?t=2" alt="A random duck" class="mx-auto border-2 border-gray-500 w-64 h-64 object-cover" onerror="this.src='https://placehold.co/256x256/ffffff/777777?text=Duck+Error'; this.onerror=null;">
                 </div>
            </div>

        </section>

    </main>

    <!-- Footer always hidden -->
    <footer class="text-center p-4 bg-[#f5f5f0] text-[#555] border-t border-[#ccc] text-sm mt-auto hidden">
        <p>¬© 2025 Aaron‚Äôs World ‚Äî Built with ‚ù§Ô∏è</p>
    </footer>

    <script>
        const galleryData = {
          "title": "Train Gallery",
          "description": "Here are some trains I've photographed up close at various railway museums and heritage lines. I love visiting these amazing pieces of history!",
          "collectionTitle": "Train Pictures Collection",
          "aboutTitle": "About These Photos",
          "aboutText": "Most photos were taken at the National Railway Museum in York, with the Double Fairlie from the Ffestiniog Railway in Wales. The Stirling Single on the turntable is my absolute favorite shot - I was lucky to capture it at just the right moment!",
          "images": [
            {"src": "https://i.ibb.co/JF5PTXW7/AP1-Gcz-MOO4-MOzy3-V-L7c-Xe-Jsxc-XDgqe9-JDHs-TJK-Qy-Ln-PKVj-Qj-NFBGNHV6-E6i-W-Yw2-H6-JS5s-Lg-exxah-R.jpg", "alt": "Henry Oakley", "caption": "GNR Class C1 \"Henry Oakley\"<br>National Railway Museum", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/HenryOakley.mp3"},
            {"src": "https://i.ibb.co/DfCZK7j1/AP1-Gcz-Mf8-Dafp8-KVxh-Onsf-DPhl-YGCd-MPUoc-PJMg-VT4g7sk-AYyx-G-npfou-Xq5-W-WV-CFKm-HHf-DL6x-R5-OYPk.jpg", "alt": "Mallard", "caption": "LNER Class A4 \"Mallard\"<br>National Railway Museum", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/Mallard.mp3"},
            {"src": "https://i.ibb.co/NHyxcYM/AP1-Gcz-NSrq-G1-TIW9mj-Hp-X2-JXa-JUUvr6i3-Ze-FOf-NUj-UDBaj-Q-r-Xrs-J9jkl-UPYCto-JBO4t-BABo001-WQ9-Vz.jpg", "alt": "KF7 Class", "caption": "Chinese KF7 Class<br>National Railway Museum", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/KF7.mp3"},
            {"src": "https://i.ibb.co/8gwmmyWw/AP1-Gcz-Mwf7-J-j3s11-Fl-Oew-I2-Hmx-Irgm-I-epf5-W3veg-C1-GJin0swi-Mmf-TQKRr-Ab-NX2r-Qa-NOMTx-Xl-M1-n.jpg", "alt": "Boxhill", "caption": "LB&SCR A1 Class \"Boxhill\"<br>National Railway Museum", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/Boxhill.mp3"},
            {"src": "https://i.ibb.co/mCk6qn9k/AP1-Gcz-MOL-Eg-KBy-KWEQOCvrq-XIZp-Iz-V7-Xn-M72-A2-TC3-S4-M33-GJx-IGgghp-FOy-NBGr9uq-Vn86aqk6-Abq4-DD.jpg", "alt": "Stirling Single", "caption": "GNR Class A2 Stirling Single on the turntable<br>National Railway Museum<br><em>My favorite photo!</em>", "featured": true, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/StirlingSingle.mp3"},
            {"src": "https://i.ibb.co/m5Lc5yHv/AP1-Gcz-Pz9p-RHa-U45hk-DB57-Yu4-x6-PT1-J3yw-H1r-Bxo-Cy-AIbi-K-AEps3-XYn1-Jq-W3-NDIJBc-VT08-JD2-MImlp.jpg", "alt": "Stephenson's Rocket", "caption": "Replica of Stephenson's Rocket<br>National Railway Museum", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/Rocket.mp3"},
            {"src": "https://i.ibb.co/9H5VPvyP/AP1-Gcz-NOKveq-nl3qrb-Agl-HBg-Hjf-ROO4pm-Vu-FFgd-Pw3aamruu5q-Gv-JGRzn-Kz-H5a-K7-G4d-P5ypcb2ll-VJVvj.jpg", "alt":"Duchess of Hamilton", "caption": "LMS Coronation Class \"Duchess of Hamilton\"<br>National Railway Museum", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/DuchessofHamilton.mp3"},
            {"src": "https://i.ibb.co/G3pd6j7C/AP1-Gcz-OR04-VD-Zq-GBF005zd-XD2m-Oj-FZZZgv-So-EN3d-UTl-JAs-Ro-Qr-LKw-KQGXMdgw-Pyg-Qm0w-FQw-Wwtx-Je-S.jpg", "alt": "James Spooner", "caption": "\"James Spooner\" Double Fairlie<br>Ffestiniog Railway, Wales", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/JamesSpooner.mp3"},
            {"src": "https://i.ibb.co/q274mKm/1000114673-4025f027-4d92-41ca-81ec-5adc5dc358fb-png.jpg", "alt": "NGG16 130", "caption": "NGG16 Class Garratt No. 130<br>Welsh Highland Railway, Wales", "featured": false, "audioSrc": "https://github.com/FascinatingPistachio/FascinatingPistachio.github.io/raw/refs/heads/main/media/NGG16.mp3"}
          ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            try {
                populateGalleries();
                setStickyTop();
                setupAllScrolls();
                // No navigation setup needed anymore
                setupAudioPlayback(); 
                
                window.addEventListener('scroll', handleScroll, { passive: true });
                window.addEventListener('resize', () => {
                    setStickyTop();
                    setupAllScrolls();
                });
            } catch (e) {
                console.error("Error initializing app:", e);
            }
        });
        
        function handleScroll() {
            if (window.innerWidth < 768) return; // Skip on mobile

            const navBarHeight = document.getElementById('main-nav')?.clientHeight || 0; // Recalculate based on restored nav
            const effectiveViewHeight = window.innerHeight - navBarHeight;

            // Handle horizontal scrolls
            document.querySelectorAll('#trains .horizontal-scroll-wrapper').forEach(wrapper => {
                const stickyContainer = wrapper.querySelector('.sticky-container');
                const gallery = stickyContainer.firstElementChild; 
                if (!gallery) return;

                const rect = wrapper.getBoundingClientRect();
                const { top } = rect;
                
                const maxScroll = gallery.scrollWidth - stickyContainer.clientWidth;
                if (maxScroll <= 0) {
                     gallery.style.transform = 'translateX(0px)';
                     return;
                }
                
                const scrollDistance = wrapper.clientHeight - effectiveViewHeight;
                if (scrollDistance <= 0) return;

                const relativeTop = top - navBarHeight;
                let scrollPercent = -relativeTop / scrollDistance;
                scrollPercent = Math.max(0, Math.min(1, scrollPercent));
                
                if (wrapper.dataset.scrollId === 'duck1') {
                    gallery.style.transform = `translateX(${(1 - scrollPercent) * maxScroll}px)`;
                } else { 
                     gallery.style.transform = `translateX(-${scrollPercent * maxScroll}px)`;
                }
            });
            
            // Handle vertical scroll-up
            document.querySelectorAll('#trains .scroll-up-wrapper').forEach(wrapper => {
                const stickyContainer = wrapper.querySelector('.scroll-up-content');
                if (!stickyContainer) return;
                
                const rect = wrapper.getBoundingClientRect();
                const { top } = rect;
                
                const scrollDistance = wrapper.clientHeight - effectiveViewHeight;
                if (scrollDistance <= 0) return;
                
                const relativeTop = top - navBarHeight;
                
                if (relativeTop <= 0 && relativeTop >= -scrollDistance) {
                    let scrollPercent = -relativeTop / scrollDistance;
                    scrollPercent = Math.max(0, Math.min(1, scrollPercent));
                    stickyContainer.style.transform = `translateY(${ (1 - scrollPercent) * 100}%)`;
                } else if (relativeTop > 0) {
                    stickyContainer.style.transform = 'translateY(100%)'; 
                } else {
                    stickyContainer.style.transform = 'translateY(0%)';
                }
            });
        }
        
        function setupAllScrolls() {
            if (window.innerWidth < 768) {
                document.querySelectorAll('#trains .horizontal-scroll-wrapper, #trains .scroll-up-wrapper').forEach(wrapper => {
                    wrapper.style.height = 'auto';
                });
                return;
            }

            const navBarHeight = document.getElementById('main-nav')?.clientHeight || 0; // Recalculate based on restored nav
            const effectiveViewHeight = window.innerHeight - navBarHeight;
            
            // Setup horizontal scrolls
            document.querySelectorAll('#trains .horizontal-scroll-wrapper').forEach(wrapper => {
                const stickyContainer = wrapper.querySelector('.sticky-container');
                const gallery = stickyContainer.firstElementChild;
                if (!gallery) return;
                
                const galleryWidth = gallery.scrollWidth;
                const viewWidth = stickyContainer.clientWidth;
                const scrollDistance = galleryWidth - viewWidth;

                if (scrollDistance > 0) {
                    wrapper.style.height = `${scrollDistance + effectiveViewHeight}px`;
                } else {
                    wrapper.style.height = 'auto';
                }
                
                if (wrapper.dataset.scrollId === 'duck1') {
                    // Start duck1 fully scrolled left (content at right)
                     gallery.style.transform = `translateX(${scrollDistance}px)`;
                } else {
                    gallery.style.transform = 'translateX(0px)';
                }
            });
            
            // Setup vertical scroll-up
            document.querySelectorAll('#trains .scroll-up-wrapper').forEach(wrapper => {
                const stickyContainer = wrapper.querySelector('.scroll-up-content');
                if (!stickyContainer) return;

                stickyContainer.style.transform = 'translateY(100%)'; 
                
                const scrollDistance = effectiveViewHeight; 
                wrapper.style.height = `${scrollDistance + effectiveViewHeight}px`;
            });
            
            handleScroll(); 
        }


        function createArtPiece(item, type, index) {
            let src, alt, caption, featured, audioSrc; 
            src = item.src;
            alt = item.alt;
            caption = item.caption;
            featured = item.featured;
            audioSrc = item.audioSrc; 

            let frameClass = 'frame-wood'; 
            if (!featured) {
                const frameType = index % 3;
                if (frameType === 1) {
                    frameClass = 'frame-dark-wood';
                } else if (frameType === 2) {
                    frameClass = 'frame-black';
                }
            }

            const playButtonHtml = audioSrc ? `
                <button class="play-audio-btn" data-audio-src="${audioSrc}" aria-label="Play audio for ${alt}">
                    üîä
                </button>
            ` : '';

            const pieceHtml = `
                <div class="art-piece ${featured ? 'featured' : ''}">
                    <div class="frame ${featured ? 'frame-wood' : frameClass}">
                        <img src="${src}" alt="${alt}" onerror="this.src='https://placehold.co/280x350/8b5a2b/ffffff?text=Image+Not+Found'; this.onerror=null;">
                    </div>
                    <div class="plaque">
                        <p>${caption}</p>
                    </div>
                    ${playButtonHtml} 
                </div>
            `;
            return pieceHtml; 
        }

        function populateGalleries() {
            const trainGrid = document.getElementById('train-gallery-grid');
            
            const trainTitle = document.getElementById('train-title');
            const trainDesc = document.getElementById('train-desc');
            const trainAboutTitle = document.getElementById('train-about-title');
            const trainAboutText = document.getElementById('train-about-text');

            if (galleryData) {
                trainTitle.textContent = galleryData.collectionTitle;
                trainDesc.textContent = galleryData.description;
                trainAboutTitle.textContent = galleryData.aboutTitle;
                trainAboutText.textContent = galleryData.aboutText;

                trainGrid.innerHTML = galleryData.images
                    .map((img, index) => createArtPiece(img, 'train', index))
                    .join('');
            }
        }
        
        function setupAudioPlayback() {
            const backgroundMusic = document.getElementById('background-music-player');
            const voiceNotePlayer = document.getElementById('voice-note-player');
            const galleryContainer = document.getElementById('train-gallery-grid'); 

            if (!backgroundMusic || !voiceNotePlayer || !galleryContainer) {
                console.error("Audio players or gallery container not found");
                return;
            }

            galleryContainer.addEventListener('click', (event) => {
                const target = event.target.closest('.play-audio-btn'); 
                if (target) {
                    const audioSrc = target.dataset.audioSrc;
                    if (audioSrc) {
                        try {
                           if (!backgroundMusic.paused) {
                                backgroundMusic.pause();
                           }
                           voiceNotePlayer.src = audioSrc;
                           voiceNotePlayer.play(); 
                        } catch (error) {
                            console.error("Error playing voice note:", error);
                            if (backgroundMusic.paused) {
                                backgroundMusic.play().catch(e => console.error("Error resuming background music:", e));
                            }
                        }
                    }
                }
            });

            voiceNotePlayer.addEventListener('ended', () => {
                backgroundMusic.play().catch(e => console.error("Error resuming background music:", e));
            });

             // Attempt to play background music after user interaction
             let interactionDone = false;
             const startBackgroundMusic = () => {
                 if (!interactionDone) {
                     backgroundMusic.play().catch(e => console.warn("Background music autoplay failed, user interaction needed.", e));
                     interactionDone = true;
                     document.removeEventListener('click', startBackgroundMusic);
                     document.removeEventListener('keydown', startBackgroundMusic);
                 }
             };
             document.addEventListener('click', startBackgroundMusic);
             document.addEventListener('keydown', startBackgroundMusic);
        }

        // No navigation function needed
        
        function setStickyTop() {
            const isMobile = window.innerWidth < 768;
            const navBarHeight = document.getElementById('main-nav')?.clientHeight || 0; // Use restored nav height
            
            document.querySelectorAll('#trains .sticky-container').forEach(container => {
                container.style.top = isMobile ? 'auto' : `${navBarHeight}px`;
            });
            document.querySelectorAll('#trains .scroll-up-content').forEach(container => {
                container.style.top = isMobile ? 'auto' : `${navBarHeight}px`;
            });
        }
    </script>
</body>
</html>

